function NewSys = CallPseudo(Sys, xlog_vec, xbest_vec)
 % NewSys = CallPseudo(Sys, xlog_vec, xbest_vec)
 % function: run pseudo-random sampling
 %
 % Inputs:
 % Sys: CoverageBreachSet object to which new samples are added.
 % xlog_vec: matrix (whose each column vector is a point) by all
 % solvers so far
 % xlog_vec, xbest_vec: Matrix whose column vectors are the set of all new points to be
 %          added.
 % Output
 % NewSys: New CoverageBreachSet object after adding all the new points.
 
 % pseudo-random sampling
 
%time_lim = input('\n Specify time limit of computation in seconds\n');
%time_limit = inf; %computation time limit

snap_grid = 'y';
switch snap_grid
    case 'y'
    CBS.SetSnapToGrid(true);
    case 'n'
    CBS.SetSnapToGrid(false);
    otherwise
        error('no epsilon resolution specified')
end

max_sim = inf; %maximal number of simulations

%% Thao uncommented this to allow automatic calls 
% fprintf('\n Choose one of the following seeds for pseudorandom sampling:\n')
% r = input('0, 5000, 10000 or 15000\n');
r = round(rand*10000000000);
rng(r,'twister');  
tic

w_rob=0.5; % weight for robustness

% since this is pseudo-random sampling only, without classification
% we call this function with init_sim = max_sim 
% init_sim=nb sim required for classification
Out = StatFalsify(Out,CBS,phi,w_rob,max_sim,max_sim,time_lim);

new_pts = transpose(Out.new_samples.pts); % column vectors of newly simulated points.
Sys = CoverageBreachSet_Add_Pts(Sys, new_pts); 
xlog_vec = [xlog_vec, new_pts];

time = toc;
fprintf('Computation time = %f seconds \n',time);